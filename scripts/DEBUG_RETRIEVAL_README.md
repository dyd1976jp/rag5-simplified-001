# æ£€ç´¢è°ƒè¯•è„šæœ¬ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

`debug_retrieval.py` æ˜¯ä¸€ä¸ªå…¨é¢çš„æ£€ç´¢ç³»ç»Ÿè¯Šæ–­å·¥å…·ï¼Œç”¨äºè°ƒè¯•å’ŒéªŒè¯ RAG5 ç³»ç»Ÿçš„æ£€ç´¢åŠŸèƒ½ã€‚å®ƒæä¾›å®Œæ•´çš„è°ƒè¯•æµç¨‹ï¼ŒåŒ…æ‹¬ï¼š

1. **æ•°æ®åº“çŠ¶æ€æ£€æŸ¥** - éªŒè¯ Qdrant å‘é‡æ•°æ®åº“çš„å¥åº·çŠ¶æ€
2. **å…³é”®è¯æœç´¢æµ‹è¯•** - ç›´æ¥åœ¨æ•°æ®åº“ä¸­æœç´¢ç‰¹å®šå…³é”®è¯
3. **åµŒå…¥æ¨¡å‹éªŒè¯** - æµ‹è¯•åµŒå…¥æ¨¡å‹æ˜¯å¦æ­£å¸¸å·¥ä½œ
4. **æŸ¥è¯¢æµ‹è¯•** - ä½¿ç”¨ä¸åŒé˜ˆå€¼æµ‹è¯•æŸ¥è¯¢æ•ˆæœ
5. **é—®é¢˜è¯Šæ–­** - è‡ªåŠ¨æ£€æµ‹å¸¸è§é—®é¢˜å¹¶æä¾›è§£å†³å»ºè®®
6. **ç”ŸæˆæŠ¥å‘Š** - ç”Ÿæˆè¯¦ç»†çš„è¯Šæ–­æŠ¥å‘Š

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ç”¨æ³•

è¿è¡Œå®Œæ•´è¯Šæ–­ï¼ˆä½¿ç”¨é»˜è®¤æŸ¥è¯¢ "äºæœ¦æœ§æ˜¯æ€ä¹ˆæ­»çš„"ï¼‰ï¼š

```bash
python scripts/debug_retrieval.py
```

### è‡ªå®šä¹‰æŸ¥è¯¢

ä½¿ç”¨è‡ªå®šä¹‰æŸ¥è¯¢è¿›è¡Œæµ‹è¯•ï¼š

```bash
python scripts/debug_retrieval.py --query "æå°å‹‡æ˜¯è°"
```

### è‡ªå®šä¹‰å…³é”®è¯

ä½¿ç”¨è‡ªå®šä¹‰å…³é”®è¯è¿›è¡Œæœç´¢æµ‹è¯•ï¼š

```bash
python scripts/debug_retrieval.py --keyword "æå°å‹‡"
```

### æŒ‡å®šé›†åˆ

æŒ‡å®šè¦æ£€æŸ¥çš„é›†åˆåç§°ï¼š

```bash
python scripts/debug_retrieval.py --collection my_collection
```

### æŒ‡å®š Qdrant URL

ä½¿ç”¨è‡ªå®šä¹‰ Qdrant åœ°å€ï¼š

```bash
python scripts/debug_retrieval.py --qdrant-url http://localhost:6333
```

### ç»„åˆä½¿ç”¨

```bash
python scripts/debug_retrieval.py \
  --query "äºæœ¦æœ§æ˜¯æ€ä¹ˆæ­»çš„" \
  --keyword "äºæœ¦æœ§" \
  --collection knowledge_base
```

## è¾“å‡ºè¯´æ˜

### 1. æ•°æ®åº“çŠ¶æ€æ£€æŸ¥

æ˜¾ç¤ºé›†åˆçš„åŸºæœ¬ä¿¡æ¯ï¼š
- é›†åˆæ˜¯å¦å­˜åœ¨
- ç‚¹æ•°é‡ï¼ˆæ–‡æ¡£åˆ†å—æ•°ï¼‰
- å‘é‡æ•°é‡
- ç´¢å¼•çŠ¶æ€
- æ ·æœ¬æ•°æ®é¢„è§ˆ

**ç¤ºä¾‹è¾“å‡ºï¼š**
```
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1. æ•°æ®åº“çŠ¶æ€æ£€æŸ¥
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

é›†åˆåç§°: knowledge_base
Qdrant URL: http://localhost:6333

âœ“ é›†åˆå­˜åœ¨
  - çŠ¶æ€: green
  - ç‚¹æ•°é‡: 150
  - å‘é‡æ•°é‡: 150
  - å·²ç´¢å¼•å‘é‡: 150

âœ“ æ•°æ®åº“åŒ…å« 150 ä¸ªæ–‡æ¡£åˆ†å—
```

### 2. å…³é”®è¯æœç´¢æµ‹è¯•

ç›´æ¥åœ¨æ•°æ®åº“ä¸­æœç´¢å…³é”®è¯ï¼ŒéªŒè¯æ–‡æ¡£æ˜¯å¦å·²æ­£ç¡®ç´¢å¼•ï¼š

**ç¤ºä¾‹è¾“å‡ºï¼š**
```
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  2. å…³é”®è¯æœç´¢æµ‹è¯•: 'äºæœ¦æœ§'
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

åœ¨æ•°æ®åº“ä¸­æœç´¢å…³é”®è¯ 'äºæœ¦æœ§'...

âœ“ æ‰¾åˆ° 5 ä¸ªåŒ…å« 'äºæœ¦æœ§' çš„æ–‡æ¡£åˆ†å—

  ç»“æœ 1:
    - æ¥æº: 1i0ae3sumrl64W5nn7PshnNla14b1c.txt
    - å‡ºç°æ¬¡æ•°: 3
    - æ–‡æœ¬ç‰‡æ®µ: äºæœ¦æœ§ï¼ˆ1988å¹´11æœˆ15æ—¥ï¼ï¼‰ï¼Œä¸­å›½å†…åœ°ç”·æ¼”å‘˜...
```

### 3. åµŒå…¥æ¨¡å‹éªŒè¯

æµ‹è¯•åµŒå…¥æ¨¡å‹æ˜¯å¦æ­£å¸¸å·¥ä½œï¼š

**ç¤ºä¾‹è¾“å‡ºï¼š**
```
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  3. åµŒå…¥æ¨¡å‹éªŒè¯
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

éªŒè¯åµŒå…¥æ¨¡å‹: bge-m3
Ollama åœ°å€: http://localhost:11434

âœ“ åµŒå…¥æ¨¡å‹å·¥ä½œæ­£å¸¸
  - æ¨¡å‹åç§°: bge-m3
  - å‘é‡ç»´åº¦: 1024
  - æœŸæœ›ç»´åº¦: 1024
  - ç»´åº¦åŒ¹é…: æ˜¯
  - å¹³å‡ç”Ÿæˆæ—¶é—´: 0.234ç§’
  - æˆåŠŸæµ‹è¯•: 3/3
```

### 4. æŸ¥è¯¢æµ‹è¯•

ä½¿ç”¨ä¸åŒé˜ˆå€¼æµ‹è¯•æŸ¥è¯¢æ•ˆæœï¼š

**ç¤ºä¾‹è¾“å‡ºï¼š**
```
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  4. æŸ¥è¯¢æµ‹è¯•: 'äºæœ¦æœ§æ˜¯æ€ä¹ˆæ­»çš„'
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

æŸ¥è¯¢: äºæœ¦æœ§æ˜¯æ€ä¹ˆæ­»çš„
æµ‹è¯•é˜ˆå€¼: [0.7, 0.5, 0.3, 0.1]

é˜ˆå€¼æµ‹è¯•ç»“æœ:
é˜ˆå€¼        ç»“æœæ•°      å¹³å‡åˆ†æ•°       
----------------------------------------
0.70       0          0.0000         
0.50       2          0.5234         
0.30       5          0.4123         
0.10       12         0.3456         

ä½¿ç”¨è‡ªé€‚åº”æœç´¢ (åˆå§‹é˜ˆå€¼: 0.3)...

âœ“ æ‰¾åˆ° 5 ä¸ªç»“æœ

  ç»“æœ 1:
    - ç›¸ä¼¼åº¦åˆ†æ•°: 0.5234
    - æ¥æº: 1i0ae3sumrl64W5nn7PshnNla14b1c.txt
    - å†…å®¹: äºæœ¦æœ§åœ¨å‰§ä¸­é¥°æ¼”...
```

### 5. é—®é¢˜è¯Šæ–­å’Œå»ºè®®

è‡ªåŠ¨æ£€æµ‹é—®é¢˜å¹¶æä¾›è§£å†³å»ºè®®ï¼š

**ç¤ºä¾‹è¾“å‡ºï¼š**
```
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  5. é—®é¢˜è¯Šæ–­å’Œå»ºè®®
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

å‘ç° 2 ä¸ªé—®é¢˜:

ğŸŸ  é«˜ä¼˜å…ˆçº§é—®é¢˜:
  1. [no_results] æŸ¥è¯¢ 'äºæœ¦æœ§æ˜¯æ€ä¹ˆæ­»çš„' æœªè¿”å›ä»»ä½•ç»“æœ

å»ºè®®çš„è§£å†³æ–¹æ¡ˆ:

1. å¯èƒ½çš„åŸå› å’Œè§£å†³æ–¹æ¡ˆ:
  1. ç›¸ä¼¼åº¦é˜ˆå€¼è¿‡é«˜ - å°è¯•é™ä½ SIMILARITY_THRESHOLD
  2. æ–‡æ¡£æœªæ­£ç¡®ç´¢å¼• - é‡æ–°ç´¢å¼•æ–‡æ¡£
  3. æŸ¥è¯¢è¯ä¸åŒ¹é… - å°è¯•ä½¿ç”¨ä¸åŒçš„æŸ¥è¯¢è¯
  4. åµŒå…¥æ¨¡å‹ä¸å…¼å®¹ - æ£€æŸ¥æ¨¡å‹æ˜¯å¦æ”¯æŒä¸­æ–‡
```

### 6. è¯Šæ–­æŠ¥å‘Š

ç”Ÿæˆè¯¦ç»†çš„è¯Šæ–­æŠ¥å‘Šå¹¶ä¿å­˜åˆ°æ–‡ä»¶ï¼š

**ç¤ºä¾‹è¾“å‡ºï¼š**
```
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  6. è¯Šæ–­æŠ¥å‘Š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

æ£€ç´¢ç³»ç»Ÿè¯Šæ–­æŠ¥å‘Š
ç”Ÿæˆæ—¶é—´: 2024-01-15 10:30:45
é›†åˆåç§°: knowledge_base
Qdrant URL: http://localhost:6333

é…ç½®ä¿¡æ¯:
  - åµŒå…¥æ¨¡å‹: bge-m3
  - ç›¸ä¼¼åº¦é˜ˆå€¼: 0.3
  - Top K: 5
  - æ··åˆæœç´¢: ç¦ç”¨
  - ä¸­æ–‡åˆ†å—å™¨: å¯ç”¨

é—®é¢˜æ€»æ•°: 2
  - ä¸¥é‡: 0
  - é«˜ä¼˜å…ˆçº§: 2
  - ä¸­ç­‰ä¼˜å…ˆçº§: 0

å»ºè®®æ•°é‡: 2

æŠ¥å‘Šå·²ä¿å­˜åˆ°: logs/debug_report_20240115_103045.txt
```

## å¸¸è§é—®é¢˜è¯Šæ–­

### é—®é¢˜ 1: é›†åˆä¸å­˜åœ¨

**ç—‡çŠ¶ï¼š**
```
âŒ é›†åˆä¸å­˜åœ¨
```

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# åˆ›å»ºé›†åˆå¹¶ç´¢å¼•æ–‡æ¡£
python -m rag5.tools.index_manager reindex --directory ./docs --collection knowledge_base
```

### é—®é¢˜ 2: æ•°æ®åº“ä¸ºç©º

**ç—‡çŠ¶ï¼š**
```
âŒ æ•°æ®åº“ä¸ºç©ºï¼Œæ²¡æœ‰ç´¢å¼•ä»»ä½•æ–‡æ¡£
```

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# ç´¢å¼•æ–‡æ¡£åˆ°æ•°æ®åº“
python scripts/ingest.py --directory ./docs
```

### é—®é¢˜ 3: æœªæ‰¾åˆ°å…³é”®è¯

**ç—‡çŠ¶ï¼š**
```
âŒ æœªæ‰¾åˆ°åŒ…å« 'äºæœ¦æœ§' çš„æ–‡æ¡£
```

**è§£å†³æ–¹æ¡ˆï¼š**
1. ç¡®è®¤æ–‡æ¡£ä¸­ç¡®å®åŒ…å«è¯¥å…³é”®è¯
2. é‡æ–°ç´¢å¼•æ–‡æ¡£ï¼š
```bash
python -m rag5.tools.index_manager reindex --directory ./docs --force
```

### é—®é¢˜ 4: åµŒå…¥æ¨¡å‹éªŒè¯å¤±è´¥

**ç—‡çŠ¶ï¼š**
```
âŒ åµŒå…¥æ¨¡å‹éªŒè¯å¤±è´¥
  - é”™è¯¯: Connection refused
```

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æ£€æŸ¥ Ollama æœåŠ¡æ˜¯å¦è¿è¡Œ
curl http://localhost:11434/api/tags

# å¦‚æœæœªè¿è¡Œï¼Œå¯åŠ¨ Ollama
ollama serve

# ç¡®è®¤æ¨¡å‹å·²å®‰è£…
ollama pull bge-m3
```

### é—®é¢˜ 5: æŸ¥è¯¢æ— ç»“æœ

**ç—‡çŠ¶ï¼š**
```
âŒ è‡ªé€‚åº”æœç´¢æœªæ‰¾åˆ°ç»“æœ
```

**è§£å†³æ–¹æ¡ˆï¼š**
1. é™ä½ç›¸ä¼¼åº¦é˜ˆå€¼ï¼ˆåœ¨ `.env` æ–‡ä»¶ä¸­ï¼‰ï¼š
```bash
SIMILARITY_THRESHOLD=0.1
```

2. å¯ç”¨æ··åˆæœç´¢ï¼š
```bash
ENABLE_HYBRID_SEARCH=true
```

3. æ£€æŸ¥æ–‡æ¡£æ˜¯å¦å·²æ­£ç¡®ç´¢å¼•
4. å°è¯•ä½¿ç”¨ä¸åŒçš„æŸ¥è¯¢è¯

## è¯Šæ–­æŠ¥å‘Šæ–‡ä»¶

è¯Šæ–­æŠ¥å‘Šä¼šè‡ªåŠ¨ä¿å­˜åˆ° `logs/` ç›®å½•ï¼Œæ–‡ä»¶åæ ¼å¼ä¸ºï¼š
```
debug_report_YYYYMMDD_HHMMSS.txt
```

æŠ¥å‘ŠåŒ…å«ï¼š
- å®Œæ•´çš„é…ç½®ä¿¡æ¯
- æ‰€æœ‰æ£€æµ‹åˆ°çš„é—®é¢˜
- è¯¦ç»†çš„è§£å†³å»ºè®®
- å¯æ‰§è¡Œçš„ä¿®å¤å‘½ä»¤

## ä¸å…¶ä»–å·¥å…·é…åˆä½¿ç”¨

### 1. æ•°æ®åº“æ£€æŸ¥å·¥å…·

```bash
# å…ˆè¿è¡Œæ•°æ®åº“æ£€æŸ¥
python -m rag5.tools.diagnostics.db_check --collection knowledge_base

# å†è¿è¡Œå®Œæ•´è¯Šæ–­
python scripts/debug_retrieval.py
```

### 2. ç´¢å¼•ç®¡ç†å·¥å…·

```bash
# å¦‚æœå‘ç°é—®é¢˜ï¼Œé‡æ–°ç´¢å¼•
python -m rag5.tools.index_manager reindex --directory ./docs --force

# éªŒè¯ç´¢å¼•ç»“æœ
python scripts/debug_retrieval.py
```

### 3. æ—¥å¿—åˆ†æ

```bash
# è¿è¡Œè¯Šæ–­æ—¶æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
tail -f logs/rag_app.log

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯è¿è¡Œè¯Šæ–­
python scripts/debug_retrieval.py
```

## é«˜çº§ç”¨æ³•

### æ‰¹é‡æµ‹è¯•å¤šä¸ªæŸ¥è¯¢

åˆ›å»ºä¸€ä¸ªæµ‹è¯•è„šæœ¬ï¼š

```bash
#!/bin/bash

queries=(
  "äºæœ¦æœ§æ˜¯æ€ä¹ˆæ­»çš„"
  "æå°å‹‡çš„å…¬å¸"
  "æŠ•èµ„æƒ…å†µ"
)

for query in "${queries[@]}"; do
  echo "æµ‹è¯•æŸ¥è¯¢: $query"
  python scripts/debug_retrieval.py --query "$query"
  echo "---"
done
```

### å®šæœŸå¥åº·æ£€æŸ¥

æ·»åŠ åˆ° cron ä»»åŠ¡ä¸­å®šæœŸè¿è¡Œï¼š

```bash
# æ¯å¤©å‡Œæ™¨ 2 ç‚¹è¿è¡Œå¥åº·æ£€æŸ¥
0 2 * * * cd /path/to/rag5-simplified && python scripts/debug_retrieval.py >> logs/health_check.log 2>&1
```

## æ³¨æ„äº‹é¡¹

1. **é¦–æ¬¡è¿è¡Œ**ï¼šç¡®ä¿å·²é…ç½® `.env` æ–‡ä»¶å¹¶å¯åŠ¨äº† Qdrant å’Œ Ollama æœåŠ¡
2. **æ—¥å¿—çº§åˆ«**ï¼šè„šæœ¬ä½¿ç”¨ DEBUG çº§åˆ«æ—¥å¿—ï¼Œä¼šè¾“å‡ºè¯¦ç»†ä¿¡æ¯
3. **æ€§èƒ½å½±å“**ï¼šå…³é”®è¯æœç´¢ä¼šéå†æ‰€æœ‰æ–‡æ¡£ï¼Œå¤§å‹æ•°æ®åº“å¯èƒ½è¾ƒæ…¢
4. **æŠ¥å‘Šå­˜å‚¨**ï¼šè¯Šæ–­æŠ¥å‘Šä¼šç´¯ç§¯åœ¨ `logs/` ç›®å½•ï¼Œå®šæœŸæ¸…ç†æ—§æŠ¥å‘Š

## æ•…éšœæ’é™¤

### è„šæœ¬æ— æ³•è¿è¡Œ

```bash
# ç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™
chmod +x scripts/debug_retrieval.py

# æ£€æŸ¥ Python è·¯å¾„
which python3

# ä½¿ç”¨å®Œæ•´è·¯å¾„è¿è¡Œ
/usr/bin/python3 scripts/debug_retrieval.py
```

### å¯¼å…¥é”™è¯¯

```bash
# ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
cd /path/to/rag5-simplified
python scripts/debug_retrieval.py

# æˆ–è®¾ç½® PYTHONPATH
export PYTHONPATH=/path/to/rag5-simplified:$PYTHONPATH
python scripts/debug_retrieval.py
```

### è¿æ¥é”™è¯¯

```bash
# æ£€æŸ¥ Qdrant æ˜¯å¦è¿è¡Œ
curl http://localhost:6333/collections

# æ£€æŸ¥ Ollama æ˜¯å¦è¿è¡Œ
curl http://localhost:11434/api/tags

# æ£€æŸ¥ .env é…ç½®
cat .env | grep -E "QDRANT_URL|OLLAMA_HOST"
```

## ç›¸å…³æ–‡æ¡£

- [æ•°æ®åº“è¯Šæ–­å·¥å…·](../rag5/tools/diagnostics/README.md)
- [ç´¢å¼•ç®¡ç†å·¥å…·](../rag5/tools/index_manager/README.md)
- [æ£€ç´¢ä¼˜åŒ–æŒ‡å—](../docs/retrieval_optimization.md)
- [ä¸­æ–‡æ–‡æœ¬å¤„ç†æŒ‡å—](../docs/chinese_text_processing.md)

## åé¦ˆå’Œæ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜æˆ–æœ‰æ”¹è¿›å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ç”Ÿæˆçš„è¯Šæ–­æŠ¥å‘Š
2. æ£€æŸ¥ `logs/` ç›®å½•ä¸­çš„æ—¥å¿—æ–‡ä»¶
3. å‚è€ƒç›¸å…³æ–‡æ¡£
4. æäº¤ issue æˆ–è”ç³»å¼€å‘å›¢é˜Ÿ
